Feature: Client secrets and keys
  As a attacker
  I want to access client secrets
  So that I can masquerade as the original client
  Scenario: Compromize web server
  @success @yolosec
  Scenario: Secrets extracted from code
    Given code repo access
    When repo is scanned
    Then secrets are revealed
  Scenario: Secrets extracted from app binary
    Given app binary access
    When binary is scanned
    Then secrets are revealed
  @success @yolosec
  Scenario: Secrets extracted via path traversal
    Given web-application uses input to calculate config file path
    And application uses web-config files for secrets
    When part of config file path is sent to web-application
    Then web-application returns config file contents
  @yolosec
  Scenario: Secrets extracted via web-server path traversal
    Given web-application config file exposed via URL
    And secrets and keys are stored in configuration file
    When request contains URL of config file
    Then web-server returns contents of config file
  Scenario: Secrets extracted via encoded path in URL
    Given web-server is vulnerable to path traversal via encoded URLs
    And secrets are stored in configuration file
    When request contains encoded URL of config file
    Then web-server returns contents of config file
  @apache
  Scenario: Secrets extracted via encoded path in URL sent to Apache Web Server
    Given web-server is Apache (version <= v2.5.50)
    And secrets are stored in configuration file
    When request to Apache Web Server contains encoded URL of config file
    Then web-server returns contents of config. file