digraph "top" {
  // Base Styling
  compound=true
  graph[style="filled, rounded" rankdir="LR" splines="true" overlap="false" nodesep="0.2" ranksep="0.9"];

  // Start and end nodes
  reality[ label="Reality"  fontname="Arial"  fontsize="20"  fontcolor="white"  fillcolor="black"  color="black"  shape="box"  style="filled, rounded" ]
  subgraph cluster_Lengthy_attacks_and_defenses {
    label=<<B>Lengthy attacks<br></br>and defenses</B>>
    graph[style="filled, rounded" rankdir="LR" splines="true" overlap="false" nodesep="0.2" ranksep="0.9" fontname="Arial"  fontsize="24"  fontcolor="black"  fillcolor="transparent"  color="gray" ];
    Third_Precondition[label="Third\nPre-condition"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="lightgray"  color="gray"]
    First_Precondition[label="First\nPre-condition"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="lightgray"  color="gray"]
    Second_Precondition[label="Second\nPre-condition"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="lightgray"  color="gray"]
    A_lengthy_attack_specification[label="A lengthy attack\nspecification"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="white"  fillcolor="red"  color="red"]
    First_Defense[label="First Defense"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="white"  fillcolor="purple"  color="blue"]
    Second_Defense[label="Second Defense"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="white"  fillcolor="purple"  color="blue"]
    Incident_Response[label="Incident\nResponse"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="white"  fillcolor="blue"  color="blue"]
    {rank="same"; Third_Precondition; First_Precondition; Second_Precondition; Third_Precondition; First_Precondition; Second_Precondition; Second_Precondition; Third_Precondition; }
  }
  Second_Precondition -> A_lengthy_attack_specification
  Second_Precondition -> Second_Defense
  Second_Precondition -> Incident_Response
  Third_Precondition -> A_lengthy_attack_specification
  Third_Precondition -> First_Defense
  Third_Precondition -> Incident_Response
  reality -> First_Precondition
  reality -> Second_Precondition
  reality -> Third_Precondition
  First_Precondition -> A_lengthy_attack_specification
  First_Precondition -> First_Defense
  A_lengthy_attack_specification -> First_Defense
  A_lengthy_attack_specification -> Second_Defense
  A_lengthy_attack_specification -> Incident_Response
  First_Defense -> Second_Defense
  subgraph cluster_Legend {
    label="Legend"
    graph[style="filled, rounded" rankdir="LR" fontsize="16" splines="true" overlap="false" nodesep="0.1" ranksep="0.2" fontname="Courier" fillcolor="lightyellow" color="yellow"];
    A[label="Pre-\nCondition"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="black"  fillcolor="lightgray"  color="gray"]
    B[label="Assumptions"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="white"  fillcolor="dimgray"  color="dimgray"]
    C[label="Attack"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="white"  fillcolor="red"  color="red"]
    D[label="Pre-emptive\nDefense"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="white"  fillcolor="purple"  color="blue"]
    E[label="Incident\nResponse"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="white"  fillcolor="blue"  color="blue"]
    F[label="Policy"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="black"  fillcolor="darkolivegreen3"  color="darkolivegreen3"]
  }
  A -> reality [style="invis" ltail="cluster_Legend"]
  B -> reality [style="invis" ltail="cluster_Legend"]
  C -> reality [style="invis" ltail="cluster_Legend"]
  D -> reality [style="invis" ltail="cluster_Legend"]
  E -> reality [style="invis" ltail="cluster_Legend"]
  F -> reality [style="invis" ltail="cluster_Legend"]
}