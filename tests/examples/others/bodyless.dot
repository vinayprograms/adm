digraph "top" {
  // Base Styling
  compound=true
  graph[style="filled, rounded" rankdir="LR" splines="true" overlap="false" nodesep="0.2" ranksep="0.9"];

  // Start and end nodes
  reality[ label="Reality"  fontname="Arial"  fontsize="20"  fontcolor="white"  fillcolor="black"  color="black"  shape="box"  style="filled, rounded" ]
  subgraph cluster_A_sample_model_to_analyze_authentication_options {
    label=<<B>A sample model to<br></br>analyze authentication<br></br>options</B>>
    graph[style="filled, rounded" rankdir="LR" splines="true" overlap="false" nodesep="0.2" ranksep="0.9" fontname="Arial"  fontsize="24"  fontcolor="black"  fillcolor="transparent"  color="gray" ];
    subgraph cluster_Minimum_Password_Requirements {
      label=<<B>Minimum Password<br></br>Requirements</B>>
      graph[style="filled, rounded" rankdir="LR" splines="true" overlap="false" nodesep="0.2" ranksep="0.9" fontname="Times"  fontsize="18"  fontcolor="black"  fillcolor="darkolivegreen3"  color="darkolivegreen3" ];
    subgraph cluster_Password_is_required_for_login {
      label=<<B>Password is<br></br>required for login</B>>
      graph[style="filled, rounded" rankdir="LR" splines="true" overlap="false" nodesep="0.2" ranksep="0.9" fontname="Times"  fontsize="18"  fontcolor="white"  fillcolor="dimgray"  color="dimgray" ];
      system_uses_passwords_for_login[label="system uses\npasswords for login"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="lightgray"  color="gray"]
      system_is_unable_to_use_any_other_authentication_method[label="system is unable\nto use any other\nauthentication method"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="lightgray"  color="gray"]
      {rank="same"; system_uses_passwords_for_login; system_is_unable_to_use_any_other_authentication_method; }
    }
      Passwords_must_not_be_reused_across_multiple_systems[label="Passwords must\nnot be reused across\nmultiple systems"  shape="box3d"  style="filled, dashed"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="transparent"  color="blue"]
      Passwords_must_not_be_stored_using_weak_hashing_algorithms[label="Passwords must\nnot be stored using\nweak hashing\nalgorithms"  shape="box3d"  style="filled, dashed"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="transparent"  color="blue"]
      Passwords_must_be_salted_before_storing[label="Passwords must be\nsalted before storing"  shape="box3d"  style="filled, dashed"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="transparent"  color="blue"]
      Password_must_be_at_least_8_characters_long[label="Password must be\nat least 8\ncharacters long"  shape="box3d"  style="filled, dashed"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="transparent"  color="blue"]
      Passwords_must_be_changed_upon_first_login[label="Passwords must be\nchanged upon first login"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="white"  fillcolor="purple"  color="blue"]
      Passwords_must_not_contain_common_dictionary_words[label="Passwords must\nnot contain common\ndictionary words"  shape="box3d"  style="filled, dashed"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="transparent"  color="blue"]
      {rank="same"; }
    }
    Bruteforce_password_guessing[label="Brute-force\npassword guessing"  shape="box3d"  style="filled, dashed"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="transparent"  color="red"]
    Reversehashing_of_password[label="Reverse-hashing\nof password"  shape="box3d"  style="filled, dashed"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="transparent"  color="red"]
    targets_default_passwords_are_publicly_known[label="target's default\npasswords are publicly\nknown"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="lightgray"  color="gray"]
    Default_password[label="Default password"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="white"  fillcolor="red"  color="red"]
    Commonly_used_password[label="Commonly used\npassword"  shape="box3d"  style="filled, dashed"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="transparent"  color="red"]
    Password_leak_via_rainbow_tables[label="Password leak via\nrainbow tables"  shape="box3d"  style="filled, dashed"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="transparent"  color="red"]
    {rank="same"; targets_default_passwords_are_publicly_known; }
  }
  Commonly_used_password -> Passwords_must_not_be_stored_using_weak_hashing_algorithms[lhead=cluster_Minimum_Password_Requirements]
  Password_leak_via_rainbow_tables -> Passwords_must_not_be_stored_using_weak_hashing_algorithms[lhead=cluster_Minimum_Password_Requirements]
  system_is_unable_to_use_any_other_authentication_method -> Passwords_must_be_changed_upon_first_login[ltail=Password_is_required_for_login]
  system_uses_passwords_for_login -> Passwords_must_not_be_reused_across_multiple_systems[ltail=cluster_Password_is_required_for_login]
  system_uses_passwords_for_login -> Passwords_must_not_be_stored_using_weak_hashing_algorithms[ltail=cluster_Password_is_required_for_login]
  system_uses_passwords_for_login -> Passwords_must_be_salted_before_storing[ltail=cluster_Password_is_required_for_login]
  system_uses_passwords_for_login -> Password_must_be_at_least_8_characters_long[ltail=cluster_Password_is_required_for_login]
  system_uses_passwords_for_login -> Passwords_must_be_changed_upon_first_login[ltail=cluster_Password_is_required_for_login]
  system_uses_passwords_for_login -> Passwords_must_not_contain_common_dictionary_words[ltail=cluster_Password_is_required_for_login]
  Reversehashing_of_password -> Passwords_must_not_be_stored_using_weak_hashing_algorithms[lhead=cluster_Minimum_Password_Requirements]
  targets_default_passwords_are_publicly_known -> Default_password
  reality -> system_uses_passwords_for_login[lhead=cluster_Password_is_required_for_login]
  reality -> Passwords_must_not_contain_common_dictionary_words
  reality -> Passwords_must_not_be_reused_across_multiple_systems
  reality -> Passwords_must_not_be_stored_using_weak_hashing_algorithms
  reality -> Passwords_must_be_salted_before_storing
  reality -> Password_must_be_at_least_8_characters_long
  reality -> Bruteforce_password_guessing
  reality -> Reversehashing_of_password
  reality -> targets_default_passwords_are_publicly_known
  reality -> Commonly_used_password
  reality -> Password_leak_via_rainbow_tables
  Default_password -> Passwords_must_be_changed_upon_first_login
  Bruteforce_password_guessing -> Passwords_must_not_be_stored_using_weak_hashing_algorithms[lhead=cluster_Minimum_Password_Requirements]
  subgraph cluster_Legend {
    label="Legend"
    graph[style="filled, rounded" rankdir="LR" fontsize="16" splines="true" overlap="false" nodesep="0.1" ranksep="0.2" fontname="Courier" fillcolor="lightyellow" color="yellow"];
    A[label="Pre-\nCondition"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="black"  fillcolor="lightgray"  color="gray"]
    B[label="Assumptions"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="white"  fillcolor="dimgray"  color="dimgray"]
    C[label="Attack"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="white"  fillcolor="red"  color="red"]
    D[label="Pre-emptive\nDefense"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="white"  fillcolor="purple"  color="blue"]
    E[label="Incident\nResponse"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="white"  fillcolor="blue"  color="blue"]
    F[label="Policy"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="black"  fillcolor="darkolivegreen3"  color="darkolivegreen3"]
  }
  A -> reality [style="invis" ltail="cluster_Legend"]
  B -> reality [style="invis" ltail="cluster_Legend"]
  C -> reality [style="invis" ltail="cluster_Legend"]
  D -> reality [style="invis" ltail="cluster_Legend"]
  E -> reality [style="invis" ltail="cluster_Legend"]
  F -> reality [style="invis" ltail="cluster_Legend"]
}