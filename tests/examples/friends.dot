digraph "top" {
  // Base Styling
  compound=true
  graph[style="filled, rounded" rankdir="LR" splines="true" overlap="false" nodesep="0.2" ranksep="0.9"];

  // Start and end nodes
  reality[ label="Reality"  fontname="Arial"  fontsize="20"  fontcolor="white"  fillcolor="black"  color="black"  shape="box"  style="filled, rounded" ]
  attacker_wins[ label="ATTACKER WINS!"  fontname="Arial"  fontsize="20"  fontcolor="red"  fillcolor="yellow"  color="red"  shape="box"  style="filled, rounded" ]
  subgraph cluster_Friends_fight {
    label=<<B>Friends fight</B>>
    graph[style="filled, rounded" rankdir="LR" splines="true" overlap="false" nodesep="0.2" ranksep="0.9" fontname="Arial"  fontsize="24"  fontcolor="black"  fillcolor="transparent"  color="gray" ];
    subgraph cluster_Adam_and_Bob_are_friends {
      label=<<B>Adam and Bob are<br></br>friends</B>>
      graph[style="filled, rounded" rankdir="LR" splines="true" overlap="false" nodesep="0.2" ranksep="0.9" fontname="Times"  fontsize="18"  fontcolor="white"  fillcolor="dimgray"  color="dimgray" ];
      Adam_and_Bob[label="Adam and Bob"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="lightgray"  color="gray"]
      some_trust_exists_between_Adam_and_Bob[label="some trust exists\nbetween Adam and Bob"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="lightgray"  color="gray"]
      {rank="same"; Adam_and_Bob; some_trust_exists_between_Adam_and_Bob; }
    }
    subgraph cluster_Honesty_is_the_best_policy {
      label=<<B>Honesty is the<br></br>best policy</B>>
      graph[style="filled, rounded" rankdir="LR" splines="true" overlap="false" nodesep="0.2" ranksep="0.9" fontname="Times"  fontsize="18"  fontcolor="black"  fillcolor="darkolivegreen3"  color="darkolivegreen3" ];
    subgraph cluster_Adam_and_Bob_are_generally_honest {
      label=<<B>Adam and Bob are<br></br>generally honest</B>>
      graph[style="filled, rounded" rankdir="LR" splines="true" overlap="false" nodesep="0.2" ranksep="0.9" fontname="Times"  fontsize="18"  fontcolor="white"  fillcolor="dimgray"  color="dimgray" ];
      Adam_and_Bob_are_good_people[label="Adam and Bob are\ngood people"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="lightgray"  color="gray"]
      Adam_and_Bob_have_a_history_of_being_honest_with_each_other[label="Adam and Bob have a\nhistory of being honest\nwith each other"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="lightgray"  color="gray"]
      {rank="same"; Adam_and_Bob_are_good_people; Adam_and_Bob_have_a_history_of_being_honest_with_each_other; }
    }
      Test_honesty[label="Test honesty"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="white"  fillcolor="purple"  color="blue"]
      {rank="same"; }
    }
    Adam_cheats_Bob[label="Adam cheats Bob"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="white"  fillcolor="red"  color="red"]
    Adam_hides_the_cheat[label="Adam hides the\ncheat"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="white"  fillcolor="red"  color="red"]
    Bob_has_been_confrontational_in_the_past[label="Bob has been\nconfrontational in the past"  shape="box3d"  style="filled, dashed"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="transparent"  color="blue"]
    Adams_cheating_is_caught[label="Adam's cheating\nis caught"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="white"  fillcolor="blue"  color="blue"]
    Bob_tries_to_verify_Adams_story[label="Bob tries to\nverify Adam's story"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="white"  fillcolor="blue"  color="blue"]
    Adam_has_cheated_before[label="Adam has cheated\nbefore"  shape="box3d"  style="filled, dashed"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="transparent"  color="red"]
    Adam_doubts_Bob[label="Adam doubts Bob"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="white"  fillcolor="red"  color="red"]
    Adam_doesnt_mind_cheating_Bob[label="Adam doesn't mind\ncheating Bob"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="16"  fontcolor="black"  fillcolor="lightgray"  color="gray"]
    {rank="same"; Adam_doesnt_mind_cheating_Bob; }
  }
  Adam_hides_the_cheat -> Bob_tries_to_verify_Adams_story
  reality -> Adam_and_Bob[lhead=cluster_Adam_and_Bob_are_friends]
  reality -> Adam_and_Bob_are_good_people[lhead=cluster_Adam_and_Bob_are_generally_honest]
  reality -> Adam_doesnt_mind_cheating_Bob
  reality -> Bob_has_been_confrontational_in_the_past
  Adam_doubts_Bob -> Test_honesty
  Adam_cheats_Bob -> Test_honesty
  Adam_cheats_Bob -> Adams_cheating_is_caught
  Adam_and_Bob_are_good_people -> Test_honesty[ltail=Adam_and_Bob_are_generally_honest]
  Adam_and_Bob -> Adam_has_cheated_before[ltail=cluster_Adam_and_Bob_are_friends]
  Adam_and_Bob -> Adam_doubts_Bob[ltail=cluster_Adam_and_Bob_are_friends]
  Adam_and_Bob -> Adam_cheats_Bob[ltail=cluster_Adam_and_Bob_are_friends]
  Adam_and_Bob -> Adam_hides_the_cheat[ltail=cluster_Adam_and_Bob_are_friends]
  Adam_and_Bob -> Adams_cheating_is_caught[ltail=cluster_Adam_and_Bob_are_friends]
  Adam_and_Bob -> Bob_tries_to_verify_Adams_story[ltail=cluster_Adam_and_Bob_are_friends]
  Adam_doesnt_mind_cheating_Bob -> Adam_cheats_Bob
  Adams_cheating_is_caught -> Adam_hides_the_cheat
  Adam_has_cheated_before -> attacker_wins[style="invis"]
  Bob_tries_to_verify_Adams_story -> attacker_wins[style="invis"]
  Bob_tries_to_verify_Adams_story -> attacker_wins[style="invis"]
  Bob_has_been_confrontational_in_the_past -> attacker_wins[style="invis"]
  Test_honesty -> attacker_wins[style="invis"]
  Test_honesty -> attacker_wins[style="invis"]
  Test_honesty -> attacker_wins[style="invis"]
  Adam_cheats_Bob -> attacker_wins[ penwidth="4"  color="red" ]
  subgraph cluster_Legend {
    label="Legend"
    graph[style="filled, rounded" rankdir="LR" fontsize="16" splines="true" overlap="false" nodesep="0.1" ranksep="0.2" fontname="Courier" fillcolor="lightyellow" color="yellow"];
    A[label="Pre-\nCondition"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="black"  fillcolor="lightgray"  color="gray"]
    B[label="Assumptions"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="white"  fillcolor="dimgray"  color="dimgray"]
    C[label="Attack"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="white"  fillcolor="red"  color="red"]
    D[label="Pre-emptive\nDefense"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="white"  fillcolor="purple"  color="blue"]
    E[label="Incident\nResponse"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="white"  fillcolor="blue"  color="blue"]
    F[label="Policy"  shape="box"  style="filled, rounded"  margin="0.2"  fontname="Arial"  fontsize="12"  fontcolor="black"  fillcolor="darkolivegreen3"  color="darkolivegreen3"]
  }
  A -> reality [style="invis" ltail="cluster_Legend"]
  B -> reality [style="invis" ltail="cluster_Legend"]
  C -> reality [style="invis" ltail="cluster_Legend"]
  D -> reality [style="invis" ltail="cluster_Legend"]
  E -> reality [style="invis" ltail="cluster_Legend"]
  F -> reality [style="invis" ltail="cluster_Legend"]
}